version: 2

sources:
  - name: alumno15
    description: "Bronze layer with raw OSS network, alarm, vendor and performance data."
    database: alumno15_dev_bronze
    schema: alumno15
    tables:

      - name: bs_by_cell_config_bandwidth
        description: "Reference table describing bandwidth options used in cell configuration."
        columns:
          - name: bandwidth_id
            description: "Identifier of the bandwidth configuration."
            tests:
              - not_null
              - unique
          - name: bandwidth_in_mhz
            description: "Bandwidth value in MHz."
          - name: description
            description: "Short description of the bandwidth configuration."
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: bs_by_cell_config_tx_rx_mode
        description: "Reference table describing TX/RX modes used in cell configuration."
        columns:
          - name: tx_rx_mode_id
            description: "Identifier of the transmit/receive mode."
            tests:
              - not_null
              - unique
          - name: num_tx_ports
            description: "Number of transmit ports."
          - name: num_rx_ports
            description: "Number of receive ports."
          - name: description
            description: "Short description of the TX/RX mode."
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: raw_alarm_logs
        description: "Raw alarm events generated by network elements, including times, severity and alarm identifiers."
        columns:
          - name: alarm_id
            description: "Alarm identifier used to group alarm events."
            tests:
              - not_null
          - name: severity
            description: "Alarm severity level."
          - name: name
            description: "Alarm name or short description."
          - name: ne_name
            description: "Network Element where the alarm occurred."
          - name: occurred_on_nt
            description: "Original occurrence time of the alarm in network time (NT) format."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: raw_brd_consumo
        description: "Reference table with typical power consumption per board type."
        columns:
          - name: vendor
            description: "Vendor name."
          - name: board_name
            description: "Board type name used for power consumption reference."
            tests:
              - not_null
              - unique
          - name: consumo_minimo_w
            description: "Minimum power consumption in watts."
          - name: consumo_medio_w
            description: "Average power consumption in watts."
          - name: consumo_tipico_w
            description: "Typical power consumption in watts."
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: raw_bs_brd
        description: "Raw board inventory and counts per Base Station."
        columns:
          - name: ne
            description: "Internal NE identifier."
          - name: node_name
            description: "Base Station name for this board inventory row."
            tests:
              - not_null
          - name: datetime_loaded
            description: "Timestamp when this record was loaded into the Bronze layer (as text)."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: raw_bs_by_cell_config
        description: "Raw configuration parameters for each radio cell per Base Station."
        columns:
          - name: node_name
            description: "Base Station name."
            tests:
              - not_null
          - name: cell_name
            description: "Cell name in OSS."
            tests:
              - not_null
              - unique
          - name: local_cell_id
            description: "Local cell identifier within the Base Station."
          - name: cellid
            description: "Cell identity within the tracking area / network."
          - name: phycellid
            description: "Physical cell identifier."
          - name: freqband
            description: "Frequency band used by the cell."
          - name: tac
            description: "Tracking Area Code associated with the cell."
          - name: datetime_loaded
            description: "Timestamp when this record was loaded into the Bronze layer (as text)."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_compound_columns_to_be_unique:
              arguments:
                column_list: ["node_name", "cell_name"]
      - name: raw_bs_by_cell_status
        description: "Raw operational and administrative status for each radio cell."
        columns:
          - name: node_name
            description: "Base Station name."
            tests:
              - not_null
          - name: cell_name
            description: "Cell name in OSS."
            tests:
              - not_null
              - unique
          - name: local_cell_id
            description: "Local cell identifier within the Base Station."
          - name: datetime_loaded
            description: "Timestamp when this record was loaded into the Bronze layer (as text)."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_compound_columns_to_be_unique:
              arguments:
                column_list: ["node_name", "cell_name"]
      - name: raw_bs_ethport
        description: "Raw Ethernet port inventory and statistics per Base Station."
        columns:
          - name: ne_name
            description: "Base Station name associated with the Ethernet port."
            tests:
              - not_null
          - name: cabinet_no
            description: "Cabinet identifier where the board is installed."
          - name: slot_no
            description: "Slot number within the cabinet."
          - name: port_no
            description: "Port number on the board."
          - name: datetime_loaded
            description: "Timestamp when this record was loaded into the Bronze layer (as text)."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
          - dbt_expectations.expect_compound_columns_to_be_unique:
              arguments:
                column_list: ["ne_name", "cabinet_no", "slot_no", "port_no"]
      - name: raw_network_elements_info
        description: "Raw network element (Base Station) metadata extracted from the OSS."
        columns:
          - name: ne_name
            description: "Network Element name (Base Station identifier in OSS)."
            tests:
              - not_null
              - unique
          - name: ne_type
            description: "Type of network element (for example eNodeB or gNodeB)."
          - name: ip_address_1
            description: "Primary IP address as reported by OSS."
          - name: vendor
            description: "Vendor name reported by OSS."
          - name: region
            description: "Region where the Base Station is deployed."
          - name: city
            description: "City where the Base Station is deployed."
          - name: datetime_loaded
            description: "Timestamp when this record was loaded into the Bronze layer (as text)."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
        config:
          loaded_at_field: datetime_loaded
      - name: raw_vendors
        description: "Vendor contact and support reference data."
        columns:
          - name: vendor_name
            description: "Vendor name."
            tests:
              - not_null
              - unique
          - name: tel_soporte
            description: "Vendor support phone number."
            tests:
              - not_null
          - name: contacto
            description: "Main vendor contact person."
            tests:
              - not_null
          - name: tel_contacto
            description: "Phone number of the contact person."
            tests:
              - not_null
          - name: correo_contacto
            description: "Email of the contact person."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_table_row_count_to_be_between:
              arguments:
                min_value: 1
      - name: stats_cell_rrc_rab
        description: "Raw RRC and RAB performance statistics per cell and time interval."
        columns:
          - name: start_time
            description: "Start time of the performance measurement interval."
            tests:
              - not_null
          - name: ne_name
            description: "Base Station name for the measurement."
          - name: cell
            description: "Cell identifier within the measurement."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_compound_columns_to_be_unique:
              arguments:
                column_list: ["cell", "start_time"]
        config:
          loaded_at_field: start_time
      - name: stats_cell_traffic
        description: "Raw traffic and throughput performance statistics per cell and time interval."
        columns:
          - name: start_time
            description: "Start time of the performance measurement interval."
            tests:
              - not_null
          - name: ne_name
            description: "Base Station name for the measurement."
          - name: cell
            description: "Cell identifier within the measurement."
            tests:
              - not_null
        tests:
          - dbt_expectations.expect_compound_columns_to_be_unique:
              arguments:
                column_list: ["cell", "start_time"]
        config:
          loaded_at_field: start_time
          freshness:
            warn_after: {count: 7, period: day}
            error_after: {count: 14, period: day}
    config:
      tags: ["bronze", "oss", "raw"]